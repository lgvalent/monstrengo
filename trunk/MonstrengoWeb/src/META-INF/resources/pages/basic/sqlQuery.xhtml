<?xml version='1.0' encoding='ISO-8859-1' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets">
	<ui:composition template="/public/basic/templates/simpleProcess.xhtml">
		<ui:param name="title" value="#{menuBean.processInfoMap.SqlQueryProcess.label}" />
		<ui:param name="icon" value="../../public/basic/img/sqlQuery.png" />
		<ui:param name="description" value="#{menuBean.processInfoMap.SqlQueryProcess.description}" />
		<ui:define name="content">
			Instrução SQL: 
			<p:selectOneMenu id="history" value="#{sqlQueryBean.history}" converter="EntityConverter">
				<p:ajax event="change" listener="#{sqlQueryBean.doChooseHistory}" update="sql"/>
				<f:selectItem itemLabel="Selecione uma SQL anterior" itemValue=""/>
				<f:selectItems value="#{sqlQueryBean.currentProcess.historyList}" var="item" 
								itemLabel="#{item.propertiesMap.ocurrencyDate.value.asString}"
								itemValue="#{item}"/>
			</p:selectOneMenu>
			<br/>
			<p:inputTextarea id="sql" value="#{sqlQueryBean.currentProcess.sql}" style="width:100%; font-family: monospace;"/>
		</ui:define>
	
		<ui:define name="actions">
			<p:commandButton value="Executar" action="#{sqlQueryBean.doExecute}" ajax="false"/>
		</ui:define>
	
		<ui:define name="result">
					#{sqlQueryBean.currentProcess.rowsFetched} registros afetados.
					<p:dataTable
						value="#{sqlQueryBean.currentProcess.result}"
					    var='item'
					    rendered="#{sqlQueryBean.currentProcess.hasResult}"
					    resizableColumns="true">
		
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[0]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 0}">
							#{item[0]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[1]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 1}">
							#{item[1]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[2]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 2}">
							#{item[2]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[3]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 3}">
							#{item[3]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[4]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 4}">
							#{item[4]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[5]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 5}">
							#{item[5]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[6]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 6}">
							#{item[6]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[7]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 7}">
							#{item[7]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[8]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 8}">
							#{item[8]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[9]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 9}">
							#{item[9]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[10]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 10}">
							#{item[10]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[11]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 11}">
							#{item[11]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[12]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 12}">
							#{item[12]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[13]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 13}">
							#{item[13]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[14]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 14}">
							#{item[14]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[15]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 15}">
							#{item[15]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[16]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 16}">
							#{item[16]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[17]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 17}">
							#{item[17]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[18]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 18}">
							#{item[18]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[19]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 19}">
							#{item[19]}
						</p:column>
						<p:column headerText="#{sqlQueryBean.currentProcess.labels[20]}" rendered="#{sqlQueryBean.currentProcess.columnsCount > 20}">
							#{item[20]}
						</p:column>
						<p:column headerText="..." rendered="#{sqlQueryBean.currentProcess.columnsCount > 21}">
							<h:outputText value="..." title="Não é possível exibir todas as colunas da consulta"/>
						</p:column>
					</p:dataTable>
		</ui:define>
	</ui:composition>
</html>
